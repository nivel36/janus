<main class="app-shell">
  <p-panel styleClass="dashboard">
    <ng-template pTemplate="header">
      <div class="dashboard-header">
        <h1 class="brand">TIMELOG</h1>
        <span class="section-label">Dashboard</span>
      </div>
    </ng-template>

    <div class="dashboard-content">
      <p-card styleClass="clock-card">
        <ng-template pTemplate="content">
          <div class="clock-card-content">
            <div class="clock-info">
              <span class="clock-label">Clock In</span>
              <time class="clock-time" [attr.datetime]="currentTimeIso()">{{ currentTimeText() }}</time>
            </div>
            <p-button
              label="Clock In"
              styleClass="clock-button"
              (onClick)="onClockIn()"
              [loading]="clockInLoading()"
            ></p-button>
          </div>
          <p class="error-message" *ngIf="clockInError() as error">{{ error }}</p>
        </ng-template>
      </p-card>

      <section class="timelog">
        <div class="timelog-header">
          <h2 class="timelog-title">Time Logs</h2>
          <p class="timelog-subtitle">BCN-HQ · aferrer@nivel36.es</p>
        </div>
        <p-table
          styleClass="timelog-table"
          [value]="logs()"
          [paginator]="true"
          [rows]="rows()"
          [first]="first()"
          [totalRecords]="totalRecords()"
          [lazy]="true"
          (onLazyLoad)="loadLogs($event)"
          [loading]="loading()"
          dataKey="entryTime"
          [showCurrentPageReport]="true"
          currentPageReportTemplate="Mostrando {first} - {last} de {totalRecords}"
        >
          <ng-template pTemplate="header">
            <tr>
              <th scope="col">Fecha</th>
              <th scope="col">Entrada</th>
              <th scope="col">Salida</th>
              <th scope="col">Duración</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-log>
            <tr>
              <td>{{ log.dateDisplay }}</td>
              <td>{{ log.entryDisplay }}</td>
              <td>{{ log.exitDisplay }}</td>
              <td>{{ log.durationDisplay }}</td>
            </tr>
          </ng-template>
          <ng-template pTemplate="emptymessage">
            <tr>
              <td colspan="4">No hay registros disponibles.</td>
            </tr>
          </ng-template>
        </p-table>
        <p class="error-message" *ngIf="tableError() as tableError">{{ tableError }}</p>
      </section>
    </div>
  </p-panel>
</main>
